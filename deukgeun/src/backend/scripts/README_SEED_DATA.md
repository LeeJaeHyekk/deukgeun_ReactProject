# 테스트 데이터 생성 가이드

이 문서는 데이터베이스에 초기 테스트 데이터를 생성하는 방법을 설명합니다.

## 📋 개요

`seedAllTestData.ts` 스크립트는 프로젝트의 모든 테이블에 테스트 데이터를 생성합니다.

## 🚀 실행 방법

### 1. 환경 설정 확인

먼저 `.env` 파일이 올바르게 설정되어 있는지 확인하세요:

```env
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=your_username
DB_PASSWORD=your_password
DB_NAME=your_database_name
NODE_ENV=development
```

### 2. 데이터베이스 연결 확인

데이터베이스가 실행 중이고 연결할 수 있는지 확인하세요.

### 3. 스크립트 실행

```bash
# 백엔드 디렉토리로 이동
cd src/backend

# 테스트 데이터 생성 실행
npm run seedAllTestData
```

또는 직접 ts-node로 실행:

```bash
npx ts-node scripts/seedAllTestData.ts
```

## 📊 생성되는 데이터

### 👥 사용자 데이터 (4명)
- **관리자**: admin@test.com / admin123!
- **일반 사용자 1**: user1@test.com / user123!
- **일반 사용자 2**: user2@test.com / user123!
- **일반 사용자 3**: user3@test.com / user123!

### 🏋️ 헬스장 데이터 (5개)
- 강남 피트니스 센터
- 홍대 헬스장
- 잠실 스포츠센터
- 건대 피트니스
- 신촌 헬스클럽

### 💪 운동 기구 데이터 (9개)
- 친업 앤 딥 스테이션
- 체스트 프레스
- 랫 풀다운
- 레그 프레스
- 숄더 프레스
- 스쿼트 랙
- 러닝머신
- 바이셉 컬
- 레그 익스텐션

### 📝 커뮤니티 데이터
- **포스트**: 5개 (운동루틴, 기구가이드, 다이어트, 팁 등)
- **댓글**: 각 포스트당 3개씩
- **아요**: 랜덤하게 생성

### 🏃 운동 관련 데이터
- **운동 계획**: 사용자별 1개씩
- **운동 목표**: 사용자별 1개씩
- **운동 세션**: 사용자별 3개씩 (최근 2주간)
- **운동 세트**: 각 세션당 3개씩
- **운동 통계**: 사용자별 7일간
- **운동 진행 상황**: 사용자별 5개씩
- **운동 알림**: 사용자별 1개씩

### 🎮 게임화 데이터
- **사용자 레벨**: 사용자별 1개씩
- **경험치 히스토리**: 사용자별 5개씩
- **사용자 스트릭**: 사용자별 1개씩
- **마일스톤**: 4개 (첫 운동, 1주일 연속, 첫 포스트, 10회 운동)
- **사용자 보상**: 사용자별 1개씩

## 🔧 스크립트 특징

### ✅ 안전성
- 기존 데이터와 충돌하지 않도록 설계
- 각 테이블별로 독립적으로 데이터 생성
- 에러 발생 시 롤백 처리

### 🔄 재실행 가능
- 스크립트를 여러 번 실행해도 안전
- 중복 데이터 방지 로직 포함

### 📈 확장성
- 새로운 테이블이나 데이터 추가 시 쉽게 확장 가능
- 모듈화된 구조로 유지보수 용이

## 🚨 주의사항

### 개발 환경에서만 실행
```bash
# 프로덕션 환경에서는 절대 실행하지 마세요!
NODE_ENV=production npm run seedAllTestData  # ❌ 위험!
```

### 데이터베이스 백업
실행 전에 기존 데이터를 백업하는 것을 권장합니다:

```sql
-- MySQL 백업 예시
mysqldump -u username -p database_name > backup_$(date +%Y%m%d_%H%M%S).sql
```

### 환경 변수 확인
실행 전 반드시 `.env` 파일의 데이터베이스 설정을 확인하세요.

## 🐛 문제 해결

### 연결 오류
```
❌ Database connection failed: Error: connect ECONNREFUSED
```
- 데이터베이스 서버가 실행 중인지 확인
- `.env` 파일의 연결 정보 확인

### 권한 오류
```
❌ Access denied for user 'username'@'localhost'
```
- 데이터베이스 사용자 권한 확인
- 비밀번호가 올바른지 확인

### 테이블 없음 오류
```
❌ Table 'database_name.table_name' doesn't exist
```
- 데이터베이스 스키마가 생성되었는지 확인
- `synchronize: true` 설정으로 테이블 자동 생성

## 📝 로그 확인

스크립트 실행 시 상세한 로그가 출력됩니다:

```
🚀 전체 테스트 데이터 생성 시작...
✅ 데이터베이스 연결 성공

👥 사용자 데이터 생성 중...
✅ 사용자 생성: 관리자 (admin@test.com)
✅ 사용자 생성: 운동맨 (user1@test.com)
...

🎉 전체 테스트 데이터 생성 완료!

📊 생성된 데이터 요약:
   👥 사용자: 4명
   🏋️ 헬스장: 5개
   💪 운동 기구: 9개
   ...
```

## 🔄 개별 스크립트 실행

특정 데이터만 생성하고 싶다면 기존 스크립트를 사용할 수 있습니다:

```bash
# 헬스장 데이터만 생성
npm run seedGyms

# 운동 저널 데이터만 생성
npm run seedWorkoutJournalData

# 샘플 기구 데이터만 생성
npx ts-node scripts/addSampleMachines.ts
```

## 📞 지원

문제가 발생하면 다음을 확인하세요:

1. 데이터베이스 연결 상태
2. 환경 변수 설정
3. 테이블 스키마 존재 여부
4. 사용자 권한

추가 도움이 필요하면 프로젝트 이슈를 생성해주세요.
